{
  "version": 3,
  "sources": ["../../../../../../src/httpsnippet-lite/esm/targets/javascript/xhr/client.ts"],
  "sourcesContent": ["// @ts-nocheck\n/**\n * @description\n * HTTP code snippet generator for native XMLHttpRequest\n *\n * @author\n * @AhmadNassri\n *\n * for any questions or issues regarding the generated code snippet, please open an issue mentioning the author.\n */\nimport stringifyObject from 'stringify-object'\n\nimport { CodeBuilder } from '../../../helpers/code-builder.js'\nimport { escapeForSingleQuotes } from '../../../helpers/escape.js'\nimport {\n  getHeader,\n  getHeaderName,\n  hasHeader,\n} from '../../../helpers/headers.js'\n\nexport const xhr = {\n  info: {\n    key: 'xhr',\n    title: 'XMLHttpRequest',\n    link: 'https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest',\n    description: 'W3C Standard API that provides scripted client functionality',\n  },\n  convert: ({ postData, allHeaders, method, fullUrl }, options) => {\n    let _a\n    const opts = {\n      indent: '  ',\n      cors: true,\n      ...options,\n    }\n    const { blank, push, join } = new CodeBuilder({ indent: opts.indent })\n    switch (\n      postData === null || postData === void 0 ? void 0 : postData.mimeType\n    ) {\n      case 'application/json':\n        push(\n          `const data = JSON.stringify(${stringifyObject(postData.jsonObj, {\n            indent: opts.indent,\n          })});`,\n        )\n        blank()\n        break\n      case 'multipart/form-data':\n        if (!postData.params) {\n          break\n        }\n        push('const data = new FormData();')\n        postData.params.forEach((param) => {\n          push(\n            `data.append('${param.name}', '${param.value || param.fileName || ''}');`,\n          )\n        })\n        // remove the contentType header\n        if (hasHeader(allHeaders, 'content-type')) {\n          if (\n            (_a = getHeader(allHeaders, 'content-type')) === null ||\n            _a === void 0\n              ? void 0\n              : _a.includes('boundary')\n          ) {\n            const headerName = getHeaderName(allHeaders, 'content-type')\n            if (headerName) {\n              delete allHeaders[headerName]\n            }\n          }\n        }\n        blank()\n        break\n      default:\n        push(\n          `const data = ${(postData === null || postData === void 0 ? void 0 : postData.text) ? `'${postData.text}'` : 'null'};`,\n        )\n        blank()\n    }\n    push('const xhr = new XMLHttpRequest();')\n    if (opts.cors) {\n      push('xhr.withCredentials = true;')\n    }\n    blank()\n    push(\"xhr.addEventListener('readystatechange', function () {\")\n    push('if (this.readyState === this.DONE) {', 1)\n    push('console.log(this.responseText);', 2)\n    push('}', 1)\n    push('});')\n    blank()\n    push(`xhr.open('${method}', '${fullUrl}');`)\n    Object.keys(allHeaders).forEach((key) => {\n      push(\n        `xhr.setRequestHeader('${key}', '${escapeForSingleQuotes(allHeaders[key])}');`,\n      )\n    })\n    blank()\n    push('xhr.send(data);')\n    return join()\n  },\n}\n"],
  "mappings": "AAUA,OAAO,qBAAqB;AAE5B,SAAS,mBAAmB;AAC5B,SAAS,6BAA6B;AACtC;AAAA,EACE;AAAA,EACA;AAAA,EACA;AAAA,OACK;AAEA,MAAM,MAAM;AAAA,EACjB,MAAM;AAAA,IACJ,KAAK;AAAA,IACL,OAAO;AAAA,IACP,MAAM;AAAA,IACN,aAAa;AAAA,EACf;AAAA,EACA,SAAS,CAAC,EAAE,UAAU,YAAY,QAAQ,QAAQ,GAAG,YAAY;AAC/D,QAAI;AACJ,UAAM,OAAO;AAAA,MACX,QAAQ;AAAA,MACR,MAAM;AAAA,MACN,GAAG;AAAA,IACL;AACA,UAAM,EAAE,OAAO,MAAM,KAAK,IAAI,IAAI,YAAY,EAAE,QAAQ,KAAK,OAAO,CAAC;AACrE,YACE,aAAa,QAAQ,aAAa,SAAS,SAAS,SAAS,UAC7D;AAAA,MACA,KAAK;AACH;AAAA,UACE,+BAA+B,gBAAgB,SAAS,SAAS;AAAA,YAC/D,QAAQ,KAAK;AAAA,UACf,CAAC,CAAC;AAAA,QACJ;AACA,cAAM;AACN;AAAA,MACF,KAAK;AACH,YAAI,CAAC,SAAS,QAAQ;AACpB;AAAA,QACF;AACA,aAAK,8BAA8B;AACnC,iBAAS,OAAO,QAAQ,CAAC,UAAU;AACjC;AAAA,YACE,gBAAgB,MAAM,IAAI,OAAO,MAAM,SAAS,MAAM,YAAY,EAAE;AAAA,UACtE;AAAA,QACF,CAAC;AAED,YAAI,UAAU,YAAY,cAAc,GAAG;AACzC,eACG,KAAK,UAAU,YAAY,cAAc,OAAO,QACjD,OAAO,SACH,SACA,GAAG,SAAS,UAAU,GAC1B;AACA,kBAAM,aAAa,cAAc,YAAY,cAAc;AAC3D,gBAAI,YAAY;AACd,qBAAO,WAAW,UAAU;AAAA,YAC9B;AAAA,UACF;AAAA,QACF;AACA,cAAM;AACN;AAAA,MACF;AACE;AAAA,UACE,iBAAiB,aAAa,QAAQ,aAAa,SAAS,SAAS,SAAS,QAAQ,IAAI,SAAS,IAAI,MAAM,MAAM;AAAA,QACrH;AACA,cAAM;AAAA,IACV;AACA,SAAK,mCAAmC;AACxC,QAAI,KAAK,MAAM;AACb,WAAK,6BAA6B;AAAA,IACpC;AACA,UAAM;AACN,SAAK,wDAAwD;AAC7D,SAAK,wCAAwC,CAAC;AAC9C,SAAK,mCAAmC,CAAC;AACzC,SAAK,KAAK,CAAC;AACX,SAAK,KAAK;AACV,UAAM;AACN,SAAK,aAAa,MAAM,OAAO,OAAO,KAAK;AAC3C,WAAO,KAAK,UAAU,EAAE,QAAQ,CAAC,QAAQ;AACvC;AAAA,QACE,yBAAyB,GAAG,OAAO,sBAAsB,WAAW,GAAG,CAAC,CAAC;AAAA,MAC3E;AAAA,IACF,CAAC;AACD,UAAM;AACN,SAAK,iBAAiB;AACtB,WAAO,KAAK;AAAA,EACd;AACF;",
  "names": []
}

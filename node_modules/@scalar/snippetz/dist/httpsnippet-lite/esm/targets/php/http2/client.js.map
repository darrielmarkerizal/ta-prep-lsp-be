{
  "version": 3,
  "sources": ["../../../../../../src/httpsnippet-lite/esm/targets/php/http2/client.ts"],
  "sourcesContent": ["// @ts-nocheck\n/**\n * @description\n * HTTP code snippet generator for PHP using curl-ext.\n *\n * @author\n * @AhmadNassri\n *\n * for any questions or issues regarding the generated code snippet, please open an issue mentioning the author.\n */\nimport { CodeBuilder } from '../../../helpers/code-builder.js'\nimport {\n  getHeader,\n  getHeaderName,\n  hasHeader,\n} from '../../../helpers/headers.js'\nimport { convertType } from '../helpers.js'\n\nexport const http2 = {\n  info: {\n    key: 'http2',\n    title: 'HTTP v2',\n    link: 'http://devel-m6w6.rhcloud.com/mdref/http',\n    description: 'PHP with pecl/http v2',\n  },\n  convert: (\n    { postData, headersObj, method, queryObj, cookiesObj, url },\n    options = {},\n  ) => {\n    let _a\n    const {\n      closingTag = false,\n      indent = '  ',\n      noTags = false,\n      shortTags = false,\n    } = options\n    const { push, blank, join } = new CodeBuilder({ indent })\n    let hasBody = false\n    if (!noTags) {\n      push(shortTags ? '<?' : '<?php')\n      blank()\n    }\n    push('$client = new http\\\\Client;')\n    push('$request = new http\\\\Client\\\\Request;')\n    blank()\n    switch (\n      postData === null || postData === void 0 ? void 0 : postData.mimeType\n    ) {\n      case 'application/x-www-form-urlencoded':\n        push('$body = new http\\\\Message\\\\Body;')\n        push(\n          `$body->append(new http\\\\QueryString(${convertType(postData.paramsObj, indent)}));`,\n        )\n        blank()\n        hasBody = true\n        break\n      case 'multipart/form-data': {\n        if (!postData.params) {\n          break\n        }\n        const files = []\n        const fields = {}\n        postData.params.forEach(({ name, fileName, value, contentType }) => {\n          if (fileName) {\n            files.push({\n              name,\n              type: contentType,\n              file: fileName,\n              data: value,\n            })\n            return\n          }\n          if (value) {\n            fields[name] = value\n          }\n        })\n        const field = Object.keys(fields).length\n          ? convertType(fields, indent)\n          : 'null'\n        const formValue = files.length ? convertType(files, indent) : 'null'\n        push('$body = new http\\\\Message\\\\Body;')\n        push(`$body->addForm(${field}, ${formValue});`)\n        // remove the contentType header\n        if (hasHeader(headersObj, 'content-type')) {\n          if (\n            (_a = getHeader(headersObj, 'content-type')) === null ||\n            _a === void 0\n              ? void 0\n              : _a.indexOf('boundary')\n          ) {\n            const headerName = getHeaderName(headersObj, 'content-type')\n            if (headerName) {\n              delete headersObj[headerName]\n            }\n          }\n        }\n        blank()\n        hasBody = true\n        break\n      }\n      case 'application/json':\n        push('$body = new http\\\\Message\\\\Body;')\n        push(\n          `$body->append(json_encode(${convertType(postData.jsonObj, indent)}));`,\n        )\n        hasBody = true\n        break\n      default:\n        if (postData === null || postData === void 0 ? void 0 : postData.text) {\n          push('$body = new http\\\\Message\\\\Body;')\n          push(`$body->append(${convertType(postData.text)});`)\n          blank()\n          hasBody = true\n        }\n    }\n    push(`$request->setRequestUrl(${convertType(url)});`)\n    push(`$request->setRequestMethod(${convertType(method)});`)\n    if (hasBody) {\n      push('$request->setBody($body);')\n      blank()\n    }\n    if (Object.keys(queryObj).length) {\n      push(\n        `$request->setQuery(new http\\\\QueryString(${convertType(queryObj, indent)}));`,\n      )\n      blank()\n    }\n    if (Object.keys(headersObj).length) {\n      push(`$request->setHeaders(${convertType(headersObj, indent)});`)\n      blank()\n    }\n    if (Object.keys(cookiesObj).length) {\n      blank()\n      push(`$client->setCookies(${convertType(cookiesObj, indent)});`)\n      blank()\n    }\n    push('$client->enqueue($request)->send();')\n    push('$response = $client->getResponse();')\n    blank()\n    push('echo $response->getBody();')\n    if (!noTags && closingTag) {\n      blank()\n      push('?>')\n    }\n    return join()\n  },\n}\n"],
  "mappings": "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",
  "names": []
}

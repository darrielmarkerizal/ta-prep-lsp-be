{
  "version": 3,
  "sources": ["../../../../src/plugins/php/guzzle/guzzle.ts"],
  "sourcesContent": ["import type { Plugin } from '@scalar/types/snippetz'\n\n/**\n * php/guzzle\n */\nexport const phpGuzzle: Plugin = {\n  target: 'php',\n  client: 'guzzle',\n  title: 'Guzzle',\n  generate(request, configuration) {\n    if (!request) {\n      return ''\n    }\n\n    const options: Record<string, any> = {}\n    const method = (request.method || 'GET').toUpperCase()\n    const url = request.url || ''\n\n    // Handle headers\n    if (request.headers && Array.isArray(request.headers) && request.headers.length > 0) {\n      const headers: Record<string, any> = {}\n      request.headers.forEach((header) => {\n        if (headers[header.name] === undefined) {\n          headers[header.name] = header.value\n        } else if (Array.isArray(headers[header.name])) {\n          headers[header.name].push(header.value)\n        } else {\n          headers[header.name] = [headers[header.name], header.value]\n        }\n      })\n      options.headers = headers\n    }\n\n    // Handle query parameters\n    if (request.queryString && request.queryString.length > 0) {\n      const query: Record<string, string> = {}\n      request.queryString.forEach((param) => {\n        query[param.name] = param.value\n      })\n      options.query = query\n    }\n\n    // Handle cookies\n    if (request.cookies && request.cookies.length > 0) {\n      const cookies: Record<string, string> = {}\n      request.cookies.forEach((cookie) => {\n        cookies[cookie.name] = cookie.value\n      })\n      options.cookies = cookies\n    }\n\n    // Handle authentication\n    if (configuration?.auth?.username && configuration.auth.password) {\n      options.auth = [configuration.auth.username, configuration.auth.password]\n    }\n\n    // Handle request body\n    if (request.postData) {\n      if (request.postData.mimeType === 'application/json') {\n        try {\n          options.json = JSON.parse(request.postData.text || '{}')\n        } catch (e) {\n          // If JSON parsing fails, use the raw text\n          options.body = request.postData.text\n        }\n      } else if (request.postData.mimeType === 'multipart/form-data') {\n        if (request.postData.params) {\n          options.multipart = request.postData.params.map((param) => ({\n            name: param.name,\n            contents: param.fileName ? `fopen('${param.fileName}', 'r')` : param.value || '',\n          }))\n        } else if (request.postData.text) {\n          try {\n            options.form_params = JSON.parse(request.postData.text)\n          } catch (e) {\n            options.body = request.postData.text\n          }\n        }\n      } else if (request.postData.mimeType === 'application/x-www-form-urlencoded') {\n        if (request.postData.params) {\n          const formParams: Record<string, string> = {}\n          request.postData.params.forEach((param) => {\n            formParams[param.name] = param.value || ''\n          })\n          options.form_params = formParams\n        }\n      } else {\n        // For other mime types (like application/octet-stream), use the raw body\n        options.body = request.postData.text\n      }\n    }\n\n    // Handle compressed responses\n    if (\n      request.headers &&\n      Array.isArray(request.headers) &&\n      request.headers.some((h) => h.name === 'Accept-Encoding' && h.value.includes('gzip'))\n    ) {\n      options.decode_content = true\n    }\n\n    // Generate the PHP code\n    let code = '$client = new GuzzleHttp\\\\Client();\\n\\n'\n\n    if (Object.keys(options).length > 0) {\n      // Format the options array with proper indentation\n      const formattedOptions = formatOptionsArray(options)\n      code += `$response = $client->request('${method}', '${url}', ${formattedOptions});`\n    } else {\n      code += `$response = $client->request('${method}', '${url}');`\n    }\n\n    return code\n  },\n}\n\n/**\n * Helper function to format the PHP options array with proper indentation\n */\nfunction formatOptionsArray(options: Record<string, any>, indent = 0): string {\n  if (Object.keys(options).length === 0) return '[]'\n\n  const spaces = ' '.repeat(4)\n  let result = '[\\n'\n\n  for (const [key, value] of Object.entries(options)) {\n    const formattedValue = formatValue(value, indent + 1)\n    result += `${spaces.repeat(indent + 1)}'${key}' => ${formattedValue},\\n`\n  }\n\n  result += `${spaces.repeat(indent)}]`\n  return result\n}\n\n/**\n * Helper function to format values in the PHP array\n */\nfunction formatValue(value: any, indent: number): string {\n  if (value === null) return 'null'\n  if (typeof value === 'boolean') return value ? 'true' : 'false'\n  if (typeof value === 'string' && value.startsWith('fopen(')) return value\n  if (typeof value === 'string') return `'${value}'`\n  if (typeof value === 'number') return value.toString()\n  if (Array.isArray(value)) {\n    if (value.length === 0) return '[]'\n    const spaces = ' '.repeat(4)\n    let result = '[\\n'\n    value.forEach((item) => {\n      const formattedItem = formatValue(item, indent + 1)\n      result += `${spaces.repeat(indent + 1)}${formattedItem},\\n`\n    })\n    result += `${spaces.repeat(indent)}]`\n    return result\n  }\n  if (typeof value === 'object') {\n    return formatOptionsArray(value, indent)\n  }\n  return `'${value}'`\n}\n"],
  "mappings": "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",
  "names": []
}

{
  "version": 3,
  "sources": ["../../../../src/plugins/php/curl/curl.ts"],
  "sourcesContent": ["import type { Plugin } from '@scalar/types/snippetz'\n\n/**\n * php/curl\n */\nexport const phpCurl: Plugin = {\n  target: 'php',\n  client: 'curl',\n  title: 'cURL',\n  generate(request, configuration) {\n    // Defaults\n    const normalizedRequest = {\n      method: 'GET',\n      ...request,\n    }\n\n    // Normalization\n    normalizedRequest.method = normalizedRequest.method.toUpperCase()\n\n    // Build PHP cURL code parts\n    const parts: string[] = []\n\n    // Initialize cURL\n    // URL (with query parameters)\n    const queryString = normalizedRequest.queryString?.length\n      ? '?' +\n        normalizedRequest.queryString\n          .map((param) => {\n            const encodedName = encodeURIComponent(param.name)\n            const encodedValue = encodeURIComponent(param.value)\n            return `${encodedName}=${encodedValue}`\n          })\n          .join('&')\n      : ''\n    const url = `${normalizedRequest.url}${queryString}`\n    parts.push(`$ch = curl_init(\"${url}\");`)\n    parts.push('')\n\n    // Method\n    if (normalizedRequest.method === 'POST') {\n      parts.push('curl_setopt($ch, CURLOPT_POST, true);')\n    }\n\n    // Basic Auth\n    if (configuration?.auth?.username && configuration?.auth?.password) {\n      parts.push(`curl_setopt($ch, CURLOPT_USERPWD, '${configuration.auth.username}:${configuration.auth.password}');`)\n    }\n\n    // Headers\n    if (normalizedRequest.headers?.length) {\n      const headerStrings = normalizedRequest.headers.map((header) => `'${header.name}: ${header.value}'`)\n      parts.push(`curl_setopt($ch, CURLOPT_HTTPHEADER, [${headerStrings.join(', ')}]);`)\n\n      // Add encoding option if Accept-Encoding header includes compression\n      const acceptEncoding = normalizedRequest.headers.find((header) => header.name.toLowerCase() === 'accept-encoding')\n      if (acceptEncoding && /gzip|deflate/.test(acceptEncoding.value)) {\n        parts.push(\"curl_setopt($ch, CURLOPT_ENCODING, '');\")\n      }\n    }\n\n    // Cookies\n    if (normalizedRequest.cookies?.length) {\n      const cookieString = normalizedRequest.cookies\n        .map((cookie) => {\n          const encodedName = encodeURIComponent(cookie.name)\n          const encodedValue = encodeURIComponent(cookie.value)\n          return `${encodedName}=${encodedValue}`\n        })\n        .join('; ')\n      parts.push(`curl_setopt($ch, CURLOPT_COOKIE, '${cookieString}');`)\n    }\n\n    // Body\n    if (normalizedRequest.postData) {\n      if (normalizedRequest.postData.mimeType === 'application/json') {\n        // Convert JSON to PHP array syntax\n        if (normalizedRequest.postData.text) {\n          try {\n            const jsonData = JSON.parse(normalizedRequest.postData.text)\n            const phpArray = convertToPhpArray(jsonData)\n            parts.push(`curl_setopt($ch, CURLOPT_POSTFIELDS, json_encode(${phpArray}));`)\n          } catch {\n            parts.push(`curl_setopt($ch, CURLOPT_POSTFIELDS, '${normalizedRequest.postData.text}');`)\n          }\n        }\n      } else if (normalizedRequest.postData.mimeType === 'multipart/form-data' && normalizedRequest.postData.params) {\n        // Handle multipart form data\n        const formData = normalizedRequest.postData.params.reduce((acc, param) => {\n          if (param.fileName !== undefined) {\n            acc.push(`'${param.name}' => '@${param.fileName}'`)\n          } else if (param.value !== undefined) {\n            acc.push(`'${param.name}' => '${param.value}'`)\n          }\n          return acc\n        }, [] as string[])\n\n        parts.push(`curl_setopt($ch, CURLOPT_HTTPHEADER, ['Content-Type: multipart/form-data']);`)\n        parts.push(`curl_setopt($ch, CURLOPT_POSTFIELDS, [${formData.join(', ')}]);`)\n      } else if (\n        normalizedRequest.postData.mimeType === 'application/x-www-form-urlencoded' &&\n        normalizedRequest.postData.params\n      ) {\n        // Handle URL-encoded form data\n        const formData = normalizedRequest.postData.params\n          .map((param) => {\n            const encodedName = encodeURIComponent(param.name)\n            const encodedValue = param.value ? encodeURIComponent(param.value) : ''\n            return `${encodedName}=${encodedValue}`\n          })\n          .join('&')\n        parts.push(`curl_setopt($ch, CURLOPT_HTTPHEADER, ['Content-Type: application/x-www-form-urlencoded']);`)\n        parts.push(`curl_setopt($ch, CURLOPT_POSTFIELDS, '${formData}');`)\n      } else if (normalizedRequest.postData.mimeType === 'application/octet-stream') {\n        parts.push(`curl_setopt($ch, CURLOPT_HTTPHEADER, ['Content-Type: application/octet-stream']);`)\n        parts.push(`curl_setopt($ch, CURLOPT_POSTFIELDS, '${normalizedRequest.postData.text || ''}');`)\n      } else if (normalizedRequest.postData.text) {\n        // Try to parse as JSON and convert to PHP array, otherwise use raw text\n        try {\n          const jsonData = JSON.parse(normalizedRequest.postData.text)\n          const phpArray = convertToPhpArray(jsonData)\n          parts.push(`curl_setopt($ch, CURLOPT_POSTFIELDS, json_encode(${phpArray}));`)\n        } catch {\n          parts.push(`curl_setopt($ch, CURLOPT_POSTFIELDS, '${normalizedRequest.postData.text}');`)\n        }\n      }\n    }\n\n    // Execute and close\n    parts.push('')\n    parts.push('curl_exec($ch);')\n    parts.push('')\n    parts.push('curl_close($ch);')\n\n    return parts.join('\\n').replace(/\\n\\n\\n/g, '\\n\\n')\n  },\n}\n\n/**\n * Helper function to create consistent indentation\n */\nfunction indent(level: number): string {\n  return ' '.repeat(level * 2)\n}\n\n/**\n * Converts a JavaScript object to a PHP array string representation\n */\nfunction convertToPhpArray(data: unknown, indentLevel = 0): string {\n  if (data === null || data === undefined) {\n    return 'null'\n  }\n\n  if (typeof data === 'string') {\n    return `'${data.replace(/'/g, \"\\\\'\")}'`\n  }\n\n  if (typeof data === 'number' || typeof data === 'boolean') {\n    return String(data)\n  }\n\n  if (Array.isArray(data)) {\n    if (data.length === 0) {\n      return '[]'\n    }\n\n    const items = data.map((item) => convertToPhpArray(item, indentLevel + 1)).join(',\\n' + indent(indentLevel + 1))\n    return `[\\n${indent(indentLevel + 1)}${items}\\n${indent(indentLevel)}]`\n  }\n\n  if (typeof data === 'object') {\n    const entries = Object.entries(data)\n    if (entries.length === 0) {\n      return '[]'\n    }\n\n    const items = entries\n      .map(([key, value]) => `'${key}' => ${convertToPhpArray(value, indentLevel + 1)}`)\n      .join(',\\n' + indent(indentLevel + 1))\n    return `[\\n${indent(indentLevel + 1)}${items}\\n${indent(indentLevel)}]`\n  }\n\n  return 'null'\n}\n"],
  "mappings": "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",
  "names": []
}

{
  "version": 3,
  "sources": ["../../../../src/plugins/shell/curl/curl.ts"],
  "sourcesContent": ["import type { Plugin } from '@scalar/types/snippetz'\n\n/**\n * shell/curl\n */\nexport const shellCurl: Plugin = {\n  target: 'shell',\n  client: 'curl',\n  title: 'Curl',\n  generate(request, configuration) {\n    // Defaults\n    const normalizedRequest = {\n      method: 'GET',\n      ...request,\n    }\n\n    // Normalization\n    normalizedRequest.method = normalizedRequest.method.toUpperCase()\n\n    // Build curl command parts\n    const parts: string[] = ['curl']\n\n    // URL (quote if has query parameters or special characters)\n    const queryString = normalizedRequest.queryString?.length\n      ? '?' +\n        normalizedRequest.queryString\n          .map((param) => {\n            // Ensure both name and value are fully URI encoded\n            const encodedName = encodeURIComponent(param.name)\n            const encodedValue = encodeURIComponent(param.value)\n            return `${encodedName}=${encodedValue}`\n          })\n          .join('&')\n      : ''\n    const url = `${normalizedRequest.url}${queryString}`\n    const hasSpecialChars = /[\\s<>[\\]{}|\\\\^%$]/.test(url)\n    const urlPart = queryString || hasSpecialChars ? `'${url}'` : url\n    parts[0] = `curl ${urlPart}`\n\n    // Method\n    if (normalizedRequest.method !== 'GET') {\n      parts.push(`--request ${normalizedRequest.method}`)\n    }\n\n    // Basic Auth\n    if (configuration?.auth?.username && configuration?.auth?.password) {\n      parts.push(`--user '${configuration.auth.username}:${configuration.auth.password}'`)\n    }\n\n    // Headers\n    if (normalizedRequest.headers?.length) {\n      normalizedRequest.headers.forEach((header) => {\n        parts.push(`--header '${header.name}: ${header.value}'`)\n      })\n\n      // Add compressed flag if Accept-Encoding header includes compression\n      const acceptEncoding = normalizedRequest.headers.find((header) => header.name.toLowerCase() === 'accept-encoding')\n      if (acceptEncoding && /gzip|deflate/.test(acceptEncoding.value)) {\n        parts.push('--compressed')\n      }\n    }\n\n    // Cookies\n    if (normalizedRequest.cookies?.length) {\n      const cookieString = normalizedRequest.cookies\n        .map((cookie) => {\n          // Encode both cookie name and value to handle special characters\n          const encodedName = encodeURIComponent(cookie.name)\n          const encodedValue = encodeURIComponent(cookie.value)\n          return `${encodedName}=${encodedValue}`\n        })\n        .join('; ')\n      parts.push(`--cookie '${cookieString}'`)\n    }\n\n    // Body\n    if (normalizedRequest.postData) {\n      if (normalizedRequest.postData.mimeType === 'application/json') {\n        // Pretty print JSON data\n        if (normalizedRequest.postData.text) {\n          try {\n            const jsonData = JSON.parse(normalizedRequest.postData.text)\n            const prettyJson = JSON.stringify(jsonData, null, 2)\n            parts.push(`--data '${prettyJson}'`)\n          } catch {\n            // If JSON parsing fails, use the original text\n            parts.push(`--data '${normalizedRequest.postData.text}'`)\n          }\n        }\n      } else if (normalizedRequest.postData.mimeType === 'application/octet-stream') {\n        parts.push(`--data-binary '${normalizedRequest.postData.text}'`)\n      } else if (\n        normalizedRequest.postData.mimeType === 'application/x-www-form-urlencoded' &&\n        normalizedRequest.postData.params\n      ) {\n        // Handle URL-encoded form data\n        normalizedRequest.postData.params.forEach((param) => {\n          parts.push(`--data-urlencode '${encodeURIComponent(param.name)}=${param.value}'`)\n        })\n      } else if (normalizedRequest.postData.mimeType === 'multipart/form-data' && normalizedRequest.postData.params) {\n        // Handle multipart form data\n        normalizedRequest.postData.params.forEach((param) => {\n          if (param.fileName !== undefined) {\n            parts.push(`--form '${param.name}=@${param.fileName}'`)\n          } else {\n            parts.push(`--form '${param.name}=${param.value}'`)\n          }\n        })\n      } else {\n        // Try to parse and pretty print if it's JSON, otherwise use raw text\n        try {\n          const jsonData = JSON.parse(normalizedRequest.postData.text ?? '')\n          const prettyJson = JSON.stringify(jsonData, null, 2)\n          parts.push(`--data '${prettyJson}'`)\n        } catch {\n          parts.push(`--data '${normalizedRequest.postData.text}'`)\n        }\n      }\n    }\n\n    return parts.join(' \\\\\\n  ')\n  },\n}\n"],
  "mappings": "AAKO,MAAM,YAAoB;AAAA,EAC/B,QAAQ;AAAA,EACR,QAAQ;AAAA,EACR,OAAO;AAAA,EACP,SAAS,SAAS,eAAe;AAE/B,UAAM,oBAAoB;AAAA,MACxB,QAAQ;AAAA,MACR,GAAG;AAAA,IACL;AAGA,sBAAkB,SAAS,kBAAkB,OAAO,YAAY;AAGhE,UAAM,QAAkB,CAAC,MAAM;AAG/B,UAAM,cAAc,kBAAkB,aAAa,SAC/C,MACA,kBAAkB,YACf,IAAI,CAAC,UAAU;AAEd,YAAM,cAAc,mBAAmB,MAAM,IAAI;AACjD,YAAM,eAAe,mBAAmB,MAAM,KAAK;AACnD,aAAO,GAAG,WAAW,IAAI,YAAY;AAAA,IACvC,CAAC,EACA,KAAK,GAAG,IACX;AACJ,UAAM,MAAM,GAAG,kBAAkB,GAAG,GAAG,WAAW;AAClD,UAAM,kBAAkB,oBAAoB,KAAK,GAAG;AACpD,UAAM,UAAU,eAAe,kBAAkB,IAAI,GAAG,MAAM;AAC9D,UAAM,CAAC,IAAI,QAAQ,OAAO;AAG1B,QAAI,kBAAkB,WAAW,OAAO;AACtC,YAAM,KAAK,aAAa,kBAAkB,MAAM,EAAE;AAAA,IACpD;AAGA,QAAI,eAAe,MAAM,YAAY,eAAe,MAAM,UAAU;AAClE,YAAM,KAAK,WAAW,cAAc,KAAK,QAAQ,IAAI,cAAc,KAAK,QAAQ,GAAG;AAAA,IACrF;AAGA,QAAI,kBAAkB,SAAS,QAAQ;AACrC,wBAAkB,QAAQ,QAAQ,CAAC,WAAW;AAC5C,cAAM,KAAK,aAAa,OAAO,IAAI,KAAK,OAAO,KAAK,GAAG;AAAA,MACzD,CAAC;AAGD,YAAM,iBAAiB,kBAAkB,QAAQ,KAAK,CAAC,WAAW,OAAO,KAAK,YAAY,MAAM,iBAAiB;AACjH,UAAI,kBAAkB,eAAe,KAAK,eAAe,KAAK,GAAG;AAC/D,cAAM,KAAK,cAAc;AAAA,MAC3B;AAAA,IACF;AAGA,QAAI,kBAAkB,SAAS,QAAQ;AACrC,YAAM,eAAe,kBAAkB,QACpC,IAAI,CAAC,WAAW;AAEf,cAAM,cAAc,mBAAmB,OAAO,IAAI;AAClD,cAAM,eAAe,mBAAmB,OAAO,KAAK;AACpD,eAAO,GAAG,WAAW,IAAI,YAAY;AAAA,MACvC,CAAC,EACA,KAAK,IAAI;AACZ,YAAM,KAAK,aAAa,YAAY,GAAG;AAAA,IACzC;AAGA,QAAI,kBAAkB,UAAU;AAC9B,UAAI,kBAAkB,SAAS,aAAa,oBAAoB;AAE9D,YAAI,kBAAkB,SAAS,MAAM;AACnC,cAAI;AACF,kBAAM,WAAW,KAAK,MAAM,kBAAkB,SAAS,IAAI;AAC3D,kBAAM,aAAa,KAAK,UAAU,UAAU,MAAM,CAAC;AACnD,kBAAM,KAAK,WAAW,UAAU,GAAG;AAAA,UACrC,QAAQ;AAEN,kBAAM,KAAK,WAAW,kBAAkB,SAAS,IAAI,GAAG;AAAA,UAC1D;AAAA,QACF;AAAA,MACF,WAAW,kBAAkB,SAAS,aAAa,4BAA4B;AAC7E,cAAM,KAAK,kBAAkB,kBAAkB,SAAS,IAAI,GAAG;AAAA,MACjE,WACE,kBAAkB,SAAS,aAAa,uCACxC,kBAAkB,SAAS,QAC3B;AAEA,0BAAkB,SAAS,OAAO,QAAQ,CAAC,UAAU;AACnD,gBAAM,KAAK,qBAAqB,mBAAmB,MAAM,IAAI,CAAC,IAAI,MAAM,KAAK,GAAG;AAAA,QAClF,CAAC;AAAA,MACH,WAAW,kBAAkB,SAAS,aAAa,yBAAyB,kBAAkB,SAAS,QAAQ;AAE7G,0BAAkB,SAAS,OAAO,QAAQ,CAAC,UAAU;AACnD,cAAI,MAAM,aAAa,QAAW;AAChC,kBAAM,KAAK,WAAW,MAAM,IAAI,KAAK,MAAM,QAAQ,GAAG;AAAA,UACxD,OAAO;AACL,kBAAM,KAAK,WAAW,MAAM,IAAI,IAAI,MAAM,KAAK,GAAG;AAAA,UACpD;AAAA,QACF,CAAC;AAAA,MACH,OAAO;AAEL,YAAI;AACF,gBAAM,WAAW,KAAK,MAAM,kBAAkB,SAAS,QAAQ,EAAE;AACjE,gBAAM,aAAa,KAAK,UAAU,UAAU,MAAM,CAAC;AACnD,gBAAM,KAAK,WAAW,UAAU,GAAG;AAAA,QACrC,QAAQ;AACN,gBAAM,KAAK,WAAW,kBAAkB,SAAS,IAAI,GAAG;AAAA,QAC1D;AAAA,MACF;AAAA,IACF;AAEA,WAAO,MAAM,KAAK,SAAS;AAAA,EAC7B;AACF;",
  "names": []
}

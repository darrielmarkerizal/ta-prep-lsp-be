{
  "version": 3,
  "sources": ["../../src/helpers/authHelpers.ts"],
  "sourcesContent": ["import type { OpenAPIV3_1 } from '@scalar/openapi-types'\n\nimport type { Auth } from '../types'\n\n// Constants for security scheme names and URLs\nconst AUTH_SCHEMES = {\n  API_KEY: 'apikeyAuth',\n  BASIC: 'basicAuth',\n  BEARER: 'bearerAuth',\n  OAUTH2: 'oauth2Auth',\n} as const\n\nconst OAUTH2_DEFAULTS = {\n  AUTHORIZE_URL: 'https://example.com/oauth/authorize',\n  TOKEN_URL: 'https://example.com/oauth/token',\n} as const\n\ntype SecurityConfig = {\n  scheme: OpenAPIV3_1.SecuritySchemeObject\n  requirement: OpenAPIV3_1.SecurityRequirementObject\n}\n\n/**\n * Creates security configuration for API key authentication\n */\nfunction createApiKeyConfig(): SecurityConfig {\n  return {\n    scheme: {\n      type: 'apiKey',\n      name: 'api_key',\n      in: 'header',\n    },\n    requirement: { [AUTH_SCHEMES.API_KEY]: [] },\n  }\n}\n\n/**\n * Creates security configuration for Basic authentication\n */\nfunction createBasicConfig(): SecurityConfig {\n  return {\n    scheme: {\n      type: 'http',\n      scheme: 'basic',\n    },\n    requirement: { [AUTH_SCHEMES.BASIC]: [] },\n  }\n}\n\n/**\n * Creates security configuration for Bearer token authentication\n */\nfunction createBearerConfig(): SecurityConfig {\n  return {\n    scheme: {\n      type: 'http',\n      scheme: 'bearer',\n    },\n    requirement: { [AUTH_SCHEMES.BEARER]: [] },\n  }\n}\n\n/**\n * Creates security configuration for OAuth2 authentication\n */\nfunction createOAuth2Config(): SecurityConfig {\n  return {\n    scheme: {\n      type: 'oauth2',\n      flows: {\n        authorizationCode: {\n          authorizationUrl: OAUTH2_DEFAULTS.AUTHORIZE_URL,\n          tokenUrl: OAUTH2_DEFAULTS.TOKEN_URL,\n          scopes: {},\n        },\n      },\n    },\n    requirement: { [AUTH_SCHEMES.OAUTH2]: [] },\n  }\n}\n\n/**\n * Creates security configuration for no authentication\n */\nfunction createNoAuthConfig(): SecurityConfig {\n  return {\n    scheme: {},\n    requirement: {},\n  }\n}\n\n/**\n * Maps authentication types to their configuration creators\n */\nconst AUTH_TYPE_HANDLERS: Record<string, () => SecurityConfig> = {\n  apikey: createApiKeyConfig,\n  basic: createBasicConfig,\n  bearer: createBearerConfig,\n  oauth2: createOAuth2Config,\n  noauth: createNoAuthConfig,\n}\n\n/**\n * Processes authentication information from a Postman collection and updates\n * the OpenAPI document with the corresponding security schemes and requirements.\n * Supports API key, basic auth, bearer token, OAuth2, and no authentication types.\n */\nexport function processAuth(auth: Auth): {\n  securitySchemes: Record<string, OpenAPIV3_1.SecuritySchemeObject>\n  security: OpenAPIV3_1.SecurityRequirementObject[]\n} {\n  const securitySchemes: Record<string, OpenAPIV3_1.SecuritySchemeObject> = {}\n  const security: OpenAPIV3_1.SecurityRequirementObject[] = []\n\n  try {\n    const handler = AUTH_TYPE_HANDLERS[auth.type]\n    if (!handler) {\n      throw new Error(`Unsupported authentication type: ${auth.type}`)\n    }\n\n    const { scheme, requirement } = handler()\n\n    // Only add security schemes and requirements if they're not empty\n    if (Object.keys(scheme).length > 0) {\n      const schemeKey = `${auth.type}Auth`\n      securitySchemes[schemeKey] = scheme\n      security.push(requirement)\n    }\n  } catch (error) {\n    console.error('Error processing authentication:', error)\n    throw error\n  }\n\n  return { securitySchemes, security }\n}\n"],
  "mappings": "AAKA,MAAM,eAAe;AAAA,EACnB,SAAS;AAAA,EACT,OAAO;AAAA,EACP,QAAQ;AAAA,EACR,QAAQ;AACV;AAEA,MAAM,kBAAkB;AAAA,EACtB,eAAe;AAAA,EACf,WAAW;AACb;AAUA,SAAS,qBAAqC;AAC5C,SAAO;AAAA,IACL,QAAQ;AAAA,MACN,MAAM;AAAA,MACN,MAAM;AAAA,MACN,IAAI;AAAA,IACN;AAAA,IACA,aAAa,EAAE,CAAC,aAAa,OAAO,GAAG,CAAC,EAAE;AAAA,EAC5C;AACF;AAKA,SAAS,oBAAoC;AAC3C,SAAO;AAAA,IACL,QAAQ;AAAA,MACN,MAAM;AAAA,MACN,QAAQ;AAAA,IACV;AAAA,IACA,aAAa,EAAE,CAAC,aAAa,KAAK,GAAG,CAAC,EAAE;AAAA,EAC1C;AACF;AAKA,SAAS,qBAAqC;AAC5C,SAAO;AAAA,IACL,QAAQ;AAAA,MACN,MAAM;AAAA,MACN,QAAQ;AAAA,IACV;AAAA,IACA,aAAa,EAAE,CAAC,aAAa,MAAM,GAAG,CAAC,EAAE;AAAA,EAC3C;AACF;AAKA,SAAS,qBAAqC;AAC5C,SAAO;AAAA,IACL,QAAQ;AAAA,MACN,MAAM;AAAA,MACN,OAAO;AAAA,QACL,mBAAmB;AAAA,UACjB,kBAAkB,gBAAgB;AAAA,UAClC,UAAU,gBAAgB;AAAA,UAC1B,QAAQ,CAAC;AAAA,QACX;AAAA,MACF;AAAA,IACF;AAAA,IACA,aAAa,EAAE,CAAC,aAAa,MAAM,GAAG,CAAC,EAAE;AAAA,EAC3C;AACF;AAKA,SAAS,qBAAqC;AAC5C,SAAO;AAAA,IACL,QAAQ,CAAC;AAAA,IACT,aAAa,CAAC;AAAA,EAChB;AACF;AAKA,MAAM,qBAA2D;AAAA,EAC/D,QAAQ;AAAA,EACR,OAAO;AAAA,EACP,QAAQ;AAAA,EACR,QAAQ;AAAA,EACR,QAAQ;AACV;AAOO,SAAS,YAAY,MAG1B;AACA,QAAM,kBAAoE,CAAC;AAC3E,QAAM,WAAoD,CAAC;AAE3D,MAAI;AACF,UAAM,UAAU,mBAAmB,KAAK,IAAI;AAC5C,QAAI,CAAC,SAAS;AACZ,YAAM,IAAI,MAAM,oCAAoC,KAAK,IAAI,EAAE;AAAA,IACjE;AAEA,UAAM,EAAE,QAAQ,YAAY,IAAI,QAAQ;AAGxC,QAAI,OAAO,KAAK,MAAM,EAAE,SAAS,GAAG;AAClC,YAAM,YAAY,GAAG,KAAK,IAAI;AAC9B,sBAAgB,SAAS,IAAI;AAC7B,eAAS,KAAK,WAAW;AAAA,IAC3B;AAAA,EACF,SAAS,OAAO;AACd,YAAQ,MAAM,oCAAoC,KAAK;AACvD,UAAM;AAAA,EACR;AAEA,SAAO,EAAE,iBAAiB,SAAS;AACrC;",
  "names": []
}

const createWorkspaceEventBus = (options = {}) => {
  const { debug = false } = options;
  const events = /* @__PURE__ */ new Map();
  const getListeners = (event) => {
    let listeners = events.get(event);
    if (!listeners) {
      listeners = /* @__PURE__ */ new Set();
      events.set(event, listeners);
    }
    return listeners;
  };
  const log = (message, ...args) => {
    if (debug) {
      console.log(`[EventBus] ${message}`, ...args);
    }
  };
  const on = (event, listener) => {
    const listeners = getListeners(event);
    listeners.add(listener);
    log(`Added listener for "${String(event)}" (${listeners.size} total)`);
    return () => off(event, listener);
  };
  const off = (event, listener) => {
    const listeners = events.get(event);
    if (!listeners) {
      return;
    }
    listeners.delete(listener);
    log(`Removed listener for "${String(event)}" (${listeners.size} remaining)`);
    if (listeners.size === 0) {
      events.delete(event);
    }
  };
  const emit = (...args) => {
    const [event, payload] = args;
    const listeners = events.get(event);
    if (!listeners || listeners.size === 0) {
      log(`No listeners for "${String(event)}"`);
      return;
    }
    log(`Emitting "${String(event)}" to ${listeners.size} listener(s)`, payload);
    const listenersArray = Array.from(listeners);
    for (const listener of listenersArray) {
      try {
        listener(payload);
      } catch (error) {
        console.error(`[EventBus] Error in listener for "${String(event)}":`, error);
      }
    }
  };
  return {
    on,
    off,
    emit
  };
};
export {
  createWorkspaceEventBus
};
//# sourceMappingURL=bus.js.map
